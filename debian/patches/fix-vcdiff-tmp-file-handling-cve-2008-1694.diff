* A problem with insecure temporary file handling in vcdiff has been fixed.
  Patch: fix-vcdiff-tmp-file-handling-cve-2008-1694.diff
  Provided-by: Moritz Muehlenhoff <jmm@debian.org>
  Originally-reported-by: Steve Grubb
  Date: Fri, 18 Apr 2008 00:00:45 +0200
  Added-by: Rob Browning <rlb@defaultvalue.org>
  Status: incorporated upstream

  The vcdiff script should use temporary files more securely.  Without
  this fix a local attacker might have been able to use a symlink
  attack to force vcdiff to overwrite an arbitrary file.

Index: sid/lib-src/vcdiff
===================================================================
--- sid.orig/lib-src/vcdiff
+++ sid/lib-src/vcdiff
@@ -84,14 +84,14 @@
 	case $f in
 	s.* | */s.*)
 		if
-			rev1=/tmp/geta$$
+			rev1=`mktemp /tmp/geta.XXXXXXXX`
 			get -s -p -k $sid1 "$f" > $rev1 &&
 			case $sid2 in
 			'')
 				workfile=`expr " /$f" : '.*/s.\(.*\)'`
 				;;
 			*)
-				rev2=/tmp/getb$$
+				rev2=`mktemp /tmp/getb.XXXXXXXX`
 				get -s -p -k $sid2 "$f" > $rev2
 				workfile=$rev2
 			esac
